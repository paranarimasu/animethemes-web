{"version":3,"sources":["webpack:///./src/components/card/searchResult/theme.js","webpack:///./src/components/switcher/index.js","webpack:///./node_modules/use-debounce/esm/useDebounce.js","webpack:///./node_modules/use-debounce/esm/useDebouncedCallback.js","webpack:///./node_modules/dequal/lite/index.mjs","webpack:///./node_modules/swr/esm/libs/hash.js","webpack:///./node_modules/swr/esm/libs/web-preset.js","webpack:///./node_modules/swr/esm/config.js","webpack:///./node_modules/swr/esm/cache.js","webpack:///./node_modules/swr/esm/swr-config-context.js","webpack:///./node_modules/swr/esm/use-swr.js","webpack:///./node_modules/swr/esm/index.js","webpack:///./src/hooks/useSearch.js","webpack:///./src/components/search/global.js","webpack:///./src/pages/search.js","webpack:///./plugins/gatsby-source-animethemes/src/utils/withCache.js","webpack:///./src/components/card/searchResult/anime.js","webpack:///./src/components/button/play.js","webpack:///./plugins/gatsby-source-animethemes/src/index.js","webpack:///./src/components/card/searchResult/artist.js","webpack:///./node_modules/node-fetch/browser.js","webpack:///./node_modules/@babel/runtime/helpers/asyncToGenerator.js"],"names":["ThemeSearchResultCard","theme","smallCover","useImage","anime","entries","length","entry","videos","video","videoSlug","createVideoSlug","to","slug","description","link","name","title","song","songTitleLinkTo","image","StyledSwitcher","styled","Flex","attrs","flexInline","gapsRow","elevatedPrimaryBackground","Switcher","children","props","valueEquality","left","right","useDebounce","value","delay","options","eq","equalityFn","_a","state","dispatch","_b","callback","maxWait","maxWaitHandler","maxWaitArgs","leading","trailing","undefined","leadingCall","functionTimeoutHandler","isComponentUnmounted","debouncedFunction","current","cancelDebouncedCallback","clearTimeout","debouncedCallback","args","_i","arguments","apply","setTimeout","shouldCallFunction","callPending","useDebouncedCallback","cancel","previousValue","has","Object","prototype","hasOwnProperty","table","WeakMap","counter","isOnline","navigator","onLine","isDocumentVisible","document","visibilityState","fetcher","url","fetch","then","res","json","Cache","initialData","this","__cache","Map","__listeners","get","key","_key","serializeKey","set","notify","keys","Array","from","clear","delete","err","isArray","i","_hash","String","subscribe","listener","_this","Error","isSubscribed","push","index","indexOf","slowConnection","window","effectiveType","onLoadingSlow","onSuccess","onError","onErrorRetry","_","__","config","revalidate","opts","errorRetryCount","retryCount","count","Math","min","timeout","random","errorRetryInterval","focusThrottleInterval","dedupingInterval","loadingTimeout","refreshInterval","revalidateOnFocus","revalidateOnReconnect","refreshWhenHidden","refreshWhenOffline","shouldRetryOnError","suspense","compare","dequal","foo","bar","ctor","len","constructor","Date","getTime","RegExp","toString","call","SWRConfigContext","displayName","ts","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","__generator","body","f","y","t","g","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","pop","IS_SERVER","Deno","version","deno","rAF","useIsomorphicLayoutEffect","CONCURRENT_PROMISES","CONCURRENT_PROMISES_TS","FOCUS_REVALIDATORS","RECONNECT_REVALIDATORS","CACHE_REVALIDATORS","MUTATION_TS","MUTATION_END_TS","now","addEventListener","revalidators","shouldRevalidate","keyErr","keyValidating","updaters","currentData","currentError","currentIsValidating","promises","all","broadcastState","data","error","isValidating","_data","beforeMutationTs","beforeConcurrentPromisesTs","isAsyncMutation","err_1","shouldAbort","Provider","fn","fnArgs","assign","configRef","resolveData","cachedData","initialError","initialIsValidating","stateDependencies","stateRef","rerender","payload","shouldUpdateState","k","unmountedRef","initialMountedRef","keyRef","eventsRef","emit","event","params","boundMutate","addRevalidator","removeRevalidator","revlidators","revalidateOpts","loading","shouldDeduping","newData","startAt","newState","err_2","dedupe","currentHookData","latestKeyedData","softRevalidate","revalidateOnMount","pending","onFocus","onReconnect","onUpdate","updatedData","updatedError","updatedIsValidating","needUpdate","timer","tick","memoizedState","mutate","defineProperties","enumerable","latestData","latestError","fields","emptyResults","animeResults","themeResults","artistResults","fetchSearchResults","a","themes","artists","performances","map","artist","as","GlobalSearch","searchQuery","searchEntity","query","useSWR","baseUrl","join","encodeURIComponent","results","stickyResults","useRef","useSearch","isSearching","block","gapsColumn","EntitySearch","entity","useLocation","urlSuffix","search","hash","totalResults","slice","resultCards","id","variant","justifyContent","icon","faChevronDown","fixedWidth","StyledSearchPage","div","StyledSearchOptions","SearchPage","location","pathname","useMemo","match","urlParams","URLSearchParams","useState","setSearchQuery","debouncedSearchQuery","pageTitle","trim","useEffect","newUrlParams","navigate","replace","flex","setQuery","faTimes","active","cache","module","exports","init","AnimeSearchResultCard","hideThemes","animeLink","premiere","year","premiereLink","season","toLowerCase","flexWrap","gapsBoth","filter","small","faEllipsisH","StyledButtonPlay","Button","StyledPrefix","colors","secondaryBackground","primaryBackground","StyledBody","ButtonPlay","playing","faCircleNotch","faPlay","spin","lastRequest","require","withCache","process","GATSBY_API_URL","expiredTime","sleep","response","millis","fetchJsonCached","createFieldParams","ArtistSearchResultCard","useAniListArtist","global","self","getGlobal","default","bind","Headers","Request","Response","asyncGeneratorStep","gen","_next","_throw","arg","info"],"mappings":"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","file":"component---src-pages-search-js-306f8981d3c6938218bd.js","sourcesContent":["import { Link } from \"gatsby\";\nimport SearchResultCard, { SearchResultDescription } from \"components/card/searchResult\";\nimport SongTitleWithArtists from \"components/utils/songTitleWithArtists\";\nimport Text from \"components/text\";\nimport useImage from \"hooks/useImage\";\nimport createVideoSlug from \"utils/createVideoSlug\";\n\nexport default function ThemeSearchResultCard({ theme }) {\n    const { smallCover } = useImage(theme.anime);\n\n    if (!theme.entries.length) {\n        return null;\n    }\n\n    const entry = theme.entries[0];\n\n    if (!entry.videos.length) {\n        return null;\n    }\n\n    const video = entry.videos[0];\n    const videoSlug = createVideoSlug(theme, entry, video);\n    const to = `/anime/${theme.anime.slug}/${videoSlug}`;\n\n    const description = (\n        <SearchResultDescription>\n            <span>Theme</span>\n            <span>{theme.slug}</span>\n            <Link to={`/anime/${theme.anime.slug}`}>\n                <Text link>{theme.anime.name}</Text>\n            </Link>\n        </SearchResultDescription>\n    );\n\n    return (\n        <SearchResultCard\n            title={<SongTitleWithArtists song={theme.song} songTitleLinkTo={to}/>}\n            description={description}\n            image={smallCover}\n            to={to}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport elevatedPrimaryBackground from \"styles/helper\";\nimport { Flex } from \"components/flex\";\n\nconst StyledSwitcher = styled(Flex).attrs({\n    flexInline: true,\n    gapsRow: \"0.5rem\"\n})`\n    background-color: ${elevatedPrimaryBackground};\n\n    border-radius: 1rem;\n`;\n\nexport default function Switcher({ children, ...props }) {\n    return (\n        <StyledSwitcher {...props}>\n            {children}\n        </StyledSwitcher>\n    );\n}\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport useDebouncedCallback from './useDebouncedCallback';\n\nfunction valueEquality(left, right) {\n  return left === right;\n}\n\nexport default function useDebounce(value, delay, options) {\n  var eq = options && options.equalityFn ? options.equalityFn : valueEquality;\n\n  var _a = useState(value),\n      state = _a[0],\n      dispatch = _a[1];\n\n  var _b = useDebouncedCallback(useCallback(function (value) {\n    return dispatch(value);\n  }, []), delay, options),\n      callback = _b[0],\n      cancel = _b[1],\n      callPending = _b[2];\n\n  var previousValue = useRef(value);\n  useEffect(function () {\n    // We need to use this condition otherwise we will run debounce timer for the first render (including maxWait option)\n    if (!eq(previousValue.current, value)) {\n      callback(value);\n      previousValue.current = value;\n    }\n  }, [value, callback, eq]);\n  return [state, cancel, callPending];\n}","import { useRef, useCallback, useEffect } from 'react';\nexport default function useDebouncedCallback(callback, delay, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var maxWait = options.maxWait;\n  var maxWaitHandler = useRef(null);\n  var maxWaitArgs = useRef([]);\n  var leading = options.leading;\n  var trailing = options.trailing === undefined ? true : options.trailing;\n  var leadingCall = useRef(false);\n  var functionTimeoutHandler = useRef(null);\n  var isComponentUnmounted = useRef(false);\n  var debouncedFunction = useRef(callback);\n  debouncedFunction.current = callback;\n  var cancelDebouncedCallback = useCallback(function () {\n    clearTimeout(functionTimeoutHandler.current);\n    clearTimeout(maxWaitHandler.current);\n    maxWaitHandler.current = null;\n    maxWaitArgs.current = [];\n    functionTimeoutHandler.current = null;\n    leadingCall.current = false;\n  }, []);\n  useEffect(function () {\n    // We have to set isComponentUnmounted to be truth, as fast-refresh runs all useEffects\n    isComponentUnmounted.current = false;\n    return function () {\n      // we use flag, as we allow to call callPending outside the hook\n      isComponentUnmounted.current = true;\n    };\n  }, []);\n  var debouncedCallback = useCallback(function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    maxWaitArgs.current = args;\n    clearTimeout(functionTimeoutHandler.current);\n\n    if (leadingCall.current) {\n      leadingCall.current = false;\n    }\n\n    if (!functionTimeoutHandler.current && leading && !leadingCall.current) {\n      debouncedFunction.current.apply(debouncedFunction, args);\n      leadingCall.current = true;\n    }\n\n    functionTimeoutHandler.current = setTimeout(function () {\n      var shouldCallFunction = true;\n\n      if (leading && leadingCall.current) {\n        shouldCallFunction = false;\n      }\n\n      cancelDebouncedCallback();\n\n      if (!isComponentUnmounted.current && trailing && shouldCallFunction) {\n        debouncedFunction.current.apply(debouncedFunction, args);\n      }\n    }, delay);\n\n    if (maxWait && !maxWaitHandler.current && trailing) {\n      maxWaitHandler.current = setTimeout(function () {\n        var args = maxWaitArgs.current;\n        cancelDebouncedCallback();\n\n        if (!isComponentUnmounted.current) {\n          debouncedFunction.current.apply(null, args);\n        }\n      }, maxWait);\n    }\n  }, [maxWait, delay, cancelDebouncedCallback, leading, trailing]);\n  var callPending = useCallback(function () {\n    // Call pending callback only if we have anything in our queue\n    if (!functionTimeoutHandler.current) {\n      return;\n    }\n\n    debouncedFunction.current.apply(null, maxWaitArgs.current);\n    cancelDebouncedCallback();\n  }, [cancelDebouncedCallback]); // At the moment, we use 3 args array so that we save backward compatibility\n\n  return [debouncedCallback, cancelDebouncedCallback, callPending];\n}","var has = Object.prototype.hasOwnProperty;\nexport function dequal(foo, bar) {\n  var ctor, len;\n  if (foo === bar) return true;\n\n  if (foo && bar && (ctor = foo.constructor) === bar.constructor) {\n    if (ctor === Date) return foo.getTime() === bar.getTime();\n    if (ctor === RegExp) return foo.toString() === bar.toString();\n\n    if (ctor === Array) {\n      if ((len = foo.length) === bar.length) {\n        while (len-- && dequal(foo[len], bar[len])) {\n          ;\n        }\n      }\n\n      return len === -1;\n    }\n\n    if (!ctor || typeof foo === 'object') {\n      len = 0;\n\n      for (ctor in foo) {\n        if (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;\n        if (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) return false;\n      }\n\n      return Object.keys(bar).length === len;\n    }\n  }\n\n  return foo !== foo && bar !== bar;\n}","// use WeakMap to store the object->key mapping\n// so the objects can be garbage collected.\n// WeakMap uses a hashtable under the hood, so the lookup\n// complexity is almost O(1).\nvar table = new WeakMap(); // counter of the key\n\nvar counter = 0; // hashes an array of objects and returns a string\n\nexport default function hash(args) {\n  if (!args.length) return '';\n  var key = 'arg';\n\n  for (var i = 0; i < args.length; ++i) {\n    var _hash = void 0;\n\n    if (args[i] === null || typeof args[i] !== 'object' && typeof args[i] !== 'function') {\n      // need to consider the case that args[i] is a string:\n      // args[i]        _hash\n      // \"undefined\" -> '\"undefined\"'\n      // undefined   -> 'undefined'\n      // 123         -> '123'\n      // null        -> 'null'\n      // \"null\"      -> '\"null\"'\n      if (typeof args[i] === 'string') {\n        _hash = '\"' + args[i] + '\"';\n      } else {\n        _hash = String(args[i]);\n      }\n    } else {\n      if (!table.has(args[i])) {\n        _hash = counter;\n        table.set(args[i], counter++);\n      } else {\n        _hash = table.get(args[i]);\n      }\n    }\n\n    key += '@' + _hash;\n  }\n\n  return key;\n}","function isOnline() {\n  if (typeof navigator.onLine !== 'undefined') {\n    return navigator.onLine;\n  } // always assume it's online\n\n\n  return true;\n}\n\nfunction isDocumentVisible() {\n  if (typeof document !== 'undefined' && typeof document.visibilityState !== 'undefined') {\n    return document.visibilityState !== 'hidden';\n  } // always assume it's visible\n\n\n  return true;\n}\n\nvar fetcher = function fetcher(url) {\n  return fetch(url).then(function (res) {\n    return res.json();\n  });\n};\n\nexport default {\n  isOnline: isOnline,\n  isDocumentVisible: isDocumentVisible,\n  fetcher: fetcher\n};","import { dequal } from 'dequal/lite';\nimport Cache from './cache';\nimport webPreset from './libs/web-preset'; // cache\n\nvar cache = new Cache(); // error retry\n\nfunction onErrorRetry(_, __, config, revalidate, opts) {\n  if (!config.isDocumentVisible()) {\n    // if it's hidden, stop\n    // it will auto revalidate when focus\n    return;\n  }\n\n  if (typeof config.errorRetryCount === 'number' && opts.retryCount > config.errorRetryCount) {\n    return;\n  } // exponential backoff\n\n\n  var count = Math.min(opts.retryCount || 0, 8);\n  var timeout = ~~((Math.random() + 0.5) * (1 << count)) * config.errorRetryInterval;\n  setTimeout(revalidate, timeout, opts);\n} // client side: need to adjust the config\n// based on the browser status\n// slow connection (<= 70Kbps)\n\n\nvar slowConnection = typeof window !== 'undefined' && navigator['connection'] && ['slow-2g', '2g'].indexOf(navigator['connection'].effectiveType) !== -1; // config\n\nvar defaultConfig = {\n  // events\n  onLoadingSlow: function onLoadingSlow() {},\n  onSuccess: function onSuccess() {},\n  onError: function onError() {},\n  onErrorRetry: onErrorRetry,\n  errorRetryInterval: (slowConnection ? 10 : 5) * 1000,\n  focusThrottleInterval: 5 * 1000,\n  dedupingInterval: 2 * 1000,\n  loadingTimeout: (slowConnection ? 5 : 3) * 1000,\n  refreshInterval: 0,\n  revalidateOnFocus: true,\n  revalidateOnReconnect: true,\n  refreshWhenHidden: false,\n  refreshWhenOffline: false,\n  shouldRetryOnError: true,\n  suspense: false,\n  compare: dequal,\n  fetcher: webPreset.fetcher,\n  isOnline: webPreset.isOnline,\n  isDocumentVisible: webPreset.isDocumentVisible\n};\nexport { cache };\nexport default defaultConfig;","import hash from './libs/hash';\n\nvar Cache =\n/** @class */\nfunction () {\n  function Cache(initialData) {\n    if (initialData === void 0) {\n      initialData = {};\n    }\n\n    this.__cache = new Map(Object.entries(initialData));\n    this.__listeners = [];\n  }\n\n  Cache.prototype.get = function (key) {\n    var _key = this.serializeKey(key)[0];\n    return this.__cache.get(_key);\n  };\n\n  Cache.prototype.set = function (key, value) {\n    var _key = this.serializeKey(key)[0];\n\n    this.__cache.set(_key, value);\n\n    this.notify();\n  };\n\n  Cache.prototype.keys = function () {\n    return Array.from(this.__cache.keys());\n  };\n\n  Cache.prototype.has = function (key) {\n    var _key = this.serializeKey(key)[0];\n    return this.__cache.has(_key);\n  };\n\n  Cache.prototype.clear = function () {\n    this.__cache.clear();\n\n    this.notify();\n  };\n\n  Cache.prototype.delete = function (key) {\n    var _key = this.serializeKey(key)[0];\n\n    this.__cache.delete(_key);\n\n    this.notify();\n  }; // TODO: introduce namespace for the cache\n\n\n  Cache.prototype.serializeKey = function (key) {\n    var args = null;\n\n    if (typeof key === 'function') {\n      try {\n        key = key();\n      } catch (err) {\n        // dependencies not ready\n        key = '';\n      }\n    }\n\n    if (Array.isArray(key)) {\n      // args array\n      args = key;\n      key = hash(key);\n    } else {\n      // convert null to ''\n      key = String(key || '');\n    }\n\n    var errorKey = key ? 'err@' + key : '';\n    var isValidatingKey = key ? 'validating@' + key : '';\n    return [key, args, errorKey, isValidatingKey];\n  };\n\n  Cache.prototype.subscribe = function (listener) {\n    var _this = this;\n\n    if (typeof listener !== 'function') {\n      throw new Error('Expected the listener to be a function.');\n    }\n\n    var isSubscribed = true;\n\n    this.__listeners.push(listener);\n\n    return function () {\n      if (!isSubscribed) return;\n      isSubscribed = false;\n\n      var index = _this.__listeners.indexOf(listener);\n\n      if (index > -1) {\n        _this.__listeners[index] = _this.__listeners[_this.__listeners.length - 1];\n        _this.__listeners.length--;\n      }\n    };\n  }; // Notify Cache subscribers about a change in the cache\n\n\n  Cache.prototype.notify = function () {\n    for (var _i = 0, _a = this.__listeners; _i < _a.length; _i++) {\n      var listener = _a[_i];\n      listener();\n    }\n  };\n\n  return Cache;\n}();\n\nexport default Cache;","import { createContext } from 'react';\nvar SWRConfigContext = createContext({});\nSWRConfigContext.displayName = 'SWRConfigContext';\nexport default SWRConfigContext;","var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport { useCallback, useContext, useEffect, useLayoutEffect, useState, useRef, useMemo, useDebugValue } from 'react';\nimport defaultConfig, { cache } from './config';\nimport SWRConfigContext from './swr-config-context';\nvar IS_SERVER = typeof window === 'undefined' || // @ts-ignore\n!!(typeof Deno !== 'undefined' && Deno && Deno.version && Deno.version.deno); // polyfill for requestAnimationFrame\n\nvar rAF = IS_SERVER ? null : window['requestAnimationFrame'] || function (f) {\n  return setTimeout(f, 1);\n}; // React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\n\nvar useIsomorphicLayoutEffect = IS_SERVER ? useEffect : useLayoutEffect; // global state managers\n\nvar CONCURRENT_PROMISES = {};\nvar CONCURRENT_PROMISES_TS = {};\nvar FOCUS_REVALIDATORS = {};\nvar RECONNECT_REVALIDATORS = {};\nvar CACHE_REVALIDATORS = {};\nvar MUTATION_TS = {};\nvar MUTATION_END_TS = {}; // generate strictly increasing timestamps\n\nvar now = function () {\n  var ts = 0;\n  return function () {\n    return ts++;\n  };\n}(); // setup DOM events listeners for `focus` and `reconnect` actions\n\n\nif (!IS_SERVER && window.addEventListener) {\n  var revalidate_1 = function revalidate_1(revalidators) {\n    if (!defaultConfig.isDocumentVisible() || !defaultConfig.isOnline()) return;\n\n    for (var key in revalidators) {\n      if (revalidators[key][0]) revalidators[key][0]();\n    }\n  }; // focus revalidate\n\n\n  window.addEventListener('visibilitychange', function () {\n    return revalidate_1(FOCUS_REVALIDATORS);\n  }, false);\n  window.addEventListener('focus', function () {\n    return revalidate_1(FOCUS_REVALIDATORS);\n  }, false); // reconnect revalidate\n\n  window.addEventListener('online', function () {\n    return revalidate_1(RECONNECT_REVALIDATORS);\n  }, false);\n}\n\nvar trigger = function trigger(_key, shouldRevalidate) {\n  if (shouldRevalidate === void 0) {\n    shouldRevalidate = true;\n  } // we are ignoring the second argument which correspond to the arguments\n  // the fetcher will receive when key is an array\n\n\n  var _a = cache.serializeKey(_key),\n      key = _a[0],\n      keyErr = _a[2],\n      keyValidating = _a[3];\n\n  if (!key) return Promise.resolve();\n  var updaters = CACHE_REVALIDATORS[key];\n\n  if (key && updaters) {\n    var currentData = cache.get(key);\n    var currentError = cache.get(keyErr);\n    var currentIsValidating = cache.get(keyValidating);\n    var promises = [];\n\n    for (var i = 0; i < updaters.length; ++i) {\n      promises.push(updaters[i](shouldRevalidate, currentData, currentError, currentIsValidating, i > 0));\n    } // return new updated value\n\n\n    return Promise.all(promises).then(function () {\n      return cache.get(key);\n    });\n  }\n\n  return Promise.resolve(cache.get(key));\n};\n\nvar broadcastState = function broadcastState(key, data, error, isValidating) {\n  var updaters = CACHE_REVALIDATORS[key];\n\n  if (key && updaters) {\n    for (var i = 0; i < updaters.length; ++i) {\n      updaters[i](false, data, error, isValidating);\n    }\n  }\n};\n\nvar mutate = function mutate(_key, _data, shouldRevalidate) {\n  if (shouldRevalidate === void 0) {\n    shouldRevalidate = true;\n  }\n\n  return __awaiter(void 0, void 0, void 0, function () {\n    var _a, key, keyErr, beforeMutationTs, beforeConcurrentPromisesTs, data, error, isAsyncMutation, err_1, shouldAbort, updaters, promises, i;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          _a = cache.serializeKey(_key), key = _a[0], keyErr = _a[2];\n          if (!key) return [2\n          /*return*/\n          ]; // if there is no new data to update, let's just revalidate the key\n\n          if (typeof _data === 'undefined') return [2\n          /*return*/\n          , trigger(_key, shouldRevalidate) // update global timestamps\n          ]; // update global timestamps\n\n          MUTATION_TS[key] = now() - 1;\n          MUTATION_END_TS[key] = 0;\n          beforeMutationTs = MUTATION_TS[key];\n          beforeConcurrentPromisesTs = CONCURRENT_PROMISES_TS[key];\n          isAsyncMutation = false;\n\n          if (_data && typeof _data === 'function') {\n            // `_data` is a function, call it passing current cache value\n            try {\n              _data = _data(cache.get(key));\n            } catch (err) {\n              error = err;\n            }\n          }\n\n          if (!(_data && typeof _data.then === 'function')) return [3\n          /*break*/\n          , 5]; // `_data` is a promise\n\n          isAsyncMutation = true;\n          _b.label = 1;\n\n        case 1:\n          _b.trys.push([1, 3,, 4]);\n\n          return [4\n          /*yield*/\n          , _data];\n\n        case 2:\n          data = _b.sent();\n          return [3\n          /*break*/\n          , 4];\n\n        case 3:\n          err_1 = _b.sent();\n          error = err_1;\n          return [3\n          /*break*/\n          , 4];\n\n        case 4:\n          return [3\n          /*break*/\n          , 6];\n\n        case 5:\n          data = _data;\n          _b.label = 6;\n\n        case 6:\n          shouldAbort = function shouldAbort() {\n            // check if other mutations have occurred since we've started this mutation\n            if (beforeMutationTs !== MUTATION_TS[key] || beforeConcurrentPromisesTs !== CONCURRENT_PROMISES_TS[key]) {\n              if (error) throw error;\n              return true;\n            }\n          }; // if there's a race we don't update cache or broadcast change, just return the data\n\n\n          if (shouldAbort()) return [2\n          /*return*/\n          , data];\n\n          if (typeof data !== 'undefined') {\n            // update cached data\n            cache.set(key, data);\n          } // always update or reset the error\n\n\n          cache.set(keyErr, error); // reset the timestamp to mark the mutation has ended\n\n          MUTATION_END_TS[key] = now() - 1;\n          if (!!isAsyncMutation) return [3\n          /*break*/\n          , 8]; // let's always broadcast in the next tick\n          // to dedupe synchronous mutation calls\n          // check out https://github.com/vercel/swr/pull/735 for more details\n\n          return [4\n          /*yield*/\n          , 0 // we skip broadcasting if there's another mutation happened synchronously\n          ];\n\n        case 7:\n          // let's always broadcast in the next tick\n          // to dedupe synchronous mutation calls\n          // check out https://github.com/vercel/swr/pull/735 for more details\n          _b.sent(); // we skip broadcasting if there's another mutation happened synchronously\n\n\n          if (shouldAbort()) return [2\n          /*return*/\n          , data];\n          _b.label = 8;\n\n        case 8:\n          updaters = CACHE_REVALIDATORS[key];\n\n          if (updaters) {\n            promises = [];\n\n            for (i = 0; i < updaters.length; ++i) {\n              promises.push(updaters[i](!!shouldRevalidate, data, error, undefined, i > 0));\n            } // return new updated value\n\n\n            return [2\n            /*return*/\n            , Promise.all(promises).then(function () {\n              if (error) throw error;\n              return cache.get(key);\n            })];\n          } // throw error or return data to be used by caller of mutate\n\n\n          if (error) throw error;\n          return [2\n          /*return*/\n          , data];\n      }\n    });\n  });\n};\n\nfunction useSWR() {\n  var _this = this;\n\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  var _key,\n      fn,\n      config = {};\n\n  if (args.length >= 1) {\n    _key = args[0];\n  }\n\n  if (args.length > 2) {\n    fn = args[1];\n    config = args[2];\n  } else {\n    if (typeof args[1] === 'function') {\n      fn = args[1];\n    } else if (typeof args[1] === 'object') {\n      config = args[1];\n    }\n  } // we assume `key` as the identifier of the request\n  // `key` can change but `fn` shouldn't\n  // (because `revalidate` only depends on `key`)\n  // `keyErr` is the cache key for error objects\n\n\n  var _a = cache.serializeKey(_key),\n      key = _a[0],\n      fnArgs = _a[1],\n      keyErr = _a[2],\n      keyValidating = _a[3];\n\n  config = Object.assign({}, defaultConfig, useContext(SWRConfigContext), config);\n  var configRef = useRef(config);\n  useIsomorphicLayoutEffect(function () {\n    configRef.current = config;\n  });\n\n  if (typeof fn === 'undefined') {\n    // use the global fetcher\n    fn = config.fetcher;\n  }\n\n  var resolveData = function resolveData() {\n    var cachedData = cache.get(key);\n    return typeof cachedData === 'undefined' ? config.initialData : cachedData;\n  };\n\n  var initialData = resolveData();\n  var initialError = cache.get(keyErr);\n  var initialIsValidating = !!cache.get(keyValidating); // if a state is accessed (data, error or isValidating),\n  // we add the state to dependencies so if the state is\n  // updated in the future, we can trigger a rerender\n\n  var stateDependencies = useRef({\n    data: false,\n    error: false,\n    isValidating: false\n  });\n  var stateRef = useRef({\n    data: initialData,\n    error: initialError,\n    isValidating: initialIsValidating\n  }); // display the data label in the React DevTools next to SWR hooks\n\n  useDebugValue(stateRef.current.data);\n  var rerender = useState(null)[1];\n  var dispatch = useCallback(function (payload) {\n    var shouldUpdateState = false;\n\n    for (var k in payload) {\n      if (stateRef.current[k] === payload[k]) {\n        continue;\n      }\n\n      stateRef.current[k] = payload[k];\n\n      if (stateDependencies.current[k]) {\n        shouldUpdateState = true;\n      }\n    }\n\n    if (shouldUpdateState || config.suspense) {\n      // if component is unmounted, should skip rerender\n      // if component is not mounted, should skip rerender\n      if (unmountedRef.current || !initialMountedRef.current) return;\n      rerender({});\n    }\n  }, []); // error ref inside revalidate (is last request errored?)\n\n  var unmountedRef = useRef(false);\n  var keyRef = useRef(key); // check if component is mounted in suspense mode\n\n  var initialMountedRef = useRef(false); // do unmount check for callbacks\n\n  var eventsRef = useRef({\n    emit: function emit(event) {\n      var _a;\n\n      var params = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        params[_i - 1] = arguments[_i];\n      }\n\n      if (unmountedRef.current) return;\n\n      (_a = configRef.current)[event].apply(_a, params);\n    }\n  });\n  var boundMutate = useCallback(function (data, shouldRevalidate) {\n    return mutate(keyRef.current, data, shouldRevalidate);\n  }, []);\n\n  var addRevalidator = function addRevalidator(revalidators, callback) {\n    if (!callback) return;\n\n    if (!revalidators[key]) {\n      revalidators[key] = [callback];\n    } else {\n      revalidators[key].push(callback);\n    }\n  };\n\n  var removeRevalidator = function removeRevalidator(revlidators, callback) {\n    if (revlidators[key]) {\n      var revalidators = revlidators[key];\n      var index = revalidators.indexOf(callback);\n\n      if (index >= 0) {\n        // 10x faster than splice\n        // https://jsperf.com/array-remove-by-index\n        revalidators[index] = revalidators[revalidators.length - 1];\n        revalidators.pop();\n      }\n    }\n  }; // start a revalidation\n\n\n  var revalidate = useCallback(function (revalidateOpts) {\n    if (revalidateOpts === void 0) {\n      revalidateOpts = {};\n    }\n\n    return __awaiter(_this, void 0, void 0, function () {\n      var loading, shouldDeduping, newData, startAt, shouldIgnoreRequest, newState, err_2, retryCount;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!key || !fn) return [2\n            /*return*/\n            , false];\n            if (unmountedRef.current) return [2\n            /*return*/\n            , false];\n            revalidateOpts = Object.assign({\n              dedupe: false\n            }, revalidateOpts);\n            loading = true;\n            shouldDeduping = typeof CONCURRENT_PROMISES[key] !== 'undefined' && revalidateOpts.dedupe;\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 6,, 7]);\n\n            dispatch({\n              isValidating: true\n            });\n            cache.set(keyValidating, true);\n\n            if (!shouldDeduping) {\n              // also update other hooks\n              broadcastState(key, stateRef.current.data, stateRef.current.error, true);\n            }\n\n            newData = void 0;\n            startAt = void 0;\n            if (!shouldDeduping) return [3\n            /*break*/\n            , 3]; // there's already an ongoing request,\n            // this one needs to be deduplicated.\n\n            startAt = CONCURRENT_PROMISES_TS[key];\n            return [4\n            /*yield*/\n            , CONCURRENT_PROMISES[key]];\n\n          case 2:\n            newData = _a.sent();\n            return [3\n            /*break*/\n            , 5];\n\n          case 3:\n            // if no cache being rendered currently (it shows a blank page),\n            // we trigger the loading slow event.\n            if (config.loadingTimeout && !cache.get(key)) {\n              setTimeout(function () {\n                if (loading) eventsRef.current.emit('onLoadingSlow', key, config);\n              }, config.loadingTimeout);\n            }\n\n            if (fnArgs !== null) {\n              CONCURRENT_PROMISES[key] = fn.apply(void 0, fnArgs);\n            } else {\n              CONCURRENT_PROMISES[key] = fn(key);\n            }\n\n            CONCURRENT_PROMISES_TS[key] = startAt = now();\n            return [4\n            /*yield*/\n            , CONCURRENT_PROMISES[key]];\n\n          case 4:\n            newData = _a.sent();\n            setTimeout(function () {\n              delete CONCURRENT_PROMISES[key];\n              delete CONCURRENT_PROMISES_TS[key];\n            }, config.dedupingInterval); // trigger the success event,\n            // only do this for the original request.\n\n            eventsRef.current.emit('onSuccess', newData, key, config);\n            _a.label = 5;\n\n          case 5:\n            shouldIgnoreRequest = // if there're other ongoing request(s), started after the current one,\n            // we need to ignore the current one to avoid possible race conditions:\n            //   req1------------------>res1        (current one)\n            //        req2---------------->res2\n            // the request that fired later will always be kept.\n            CONCURRENT_PROMISES_TS[key] > startAt || // if there're other mutations(s), overlapped with the current revalidation:\n            // case 1:\n            //   req------------------>res\n            //       mutate------>end\n            // case 2:\n            //         req------------>res\n            //   mutate------>end\n            // case 3:\n            //   req------------------>res\n            //       mutate-------...---------->\n            // we have to ignore the revalidation result (res) because it's no longer fresh.\n            // meanwhile, a new revalidation should be triggered when the mutation ends.\n            MUTATION_TS[key] && ( // case 1\n            startAt <= MUTATION_TS[key] || // case 2\n            startAt <= MUTATION_END_TS[key] || // case 3\n            MUTATION_END_TS[key] === 0);\n\n            if (shouldIgnoreRequest) {\n              dispatch({\n                isValidating: false\n              });\n              return [2\n              /*return*/\n              , false];\n            }\n\n            cache.set(key, newData);\n            cache.set(keyErr, undefined);\n            cache.set(keyValidating, false);\n            newState = {\n              isValidating: false\n            };\n\n            if (typeof stateRef.current.error !== 'undefined') {\n              // we don't have an error\n              newState.error = undefined;\n            }\n\n            if (!config.compare(stateRef.current.data, newData)) {\n              // deep compare to avoid extra re-render\n              // data changed\n              newState.data = newData;\n            } // merge the new state\n\n\n            dispatch(newState);\n\n            if (!shouldDeduping) {\n              // also update other hooks\n              broadcastState(key, newData, newState.error, false);\n            }\n\n            return [3\n            /*break*/\n            , 7];\n\n          case 6:\n            err_2 = _a.sent();\n            delete CONCURRENT_PROMISES[key];\n            delete CONCURRENT_PROMISES_TS[key];\n            cache.set(keyErr, err_2); // get a new error\n            // don't use deep equal for errors\n\n            if (stateRef.current.error !== err_2) {\n              // we keep the stale data\n              dispatch({\n                isValidating: false,\n                error: err_2\n              });\n\n              if (!shouldDeduping) {\n                // also broadcast to update other hooks\n                broadcastState(key, undefined, err_2, false);\n              }\n            } // events and retry\n\n\n            eventsRef.current.emit('onError', err_2, key, config);\n\n            if (config.shouldRetryOnError) {\n              retryCount = (revalidateOpts.retryCount || 0) + 1;\n              eventsRef.current.emit('onErrorRetry', err_2, key, config, revalidate, Object.assign({\n                dedupe: true\n              }, revalidateOpts, {\n                retryCount: retryCount\n              }));\n            }\n\n            return [3\n            /*break*/\n            , 7];\n\n          case 7:\n            loading = false;\n            return [2\n            /*return*/\n            , true];\n        }\n      });\n    });\n  }, [key]); // mounted (client side rendering)\n\n  useIsomorphicLayoutEffect(function () {\n    if (!key) return undefined; // after `key` updates, we need to mark it as mounted\n\n    unmountedRef.current = false;\n    initialMountedRef.current = true; // after the component is mounted (hydrated),\n    // we need to update the data from the cache\n    // and trigger a revalidation\n\n    var currentHookData = stateRef.current.data;\n    var latestKeyedData = resolveData(); // update the state if the key changed (not the inital render) or cache updated\n\n    if (keyRef.current !== key) {\n      keyRef.current = key;\n    }\n\n    if (!config.compare(currentHookData, latestKeyedData)) {\n      dispatch({\n        data: latestKeyedData\n      });\n    } // revalidate with deduping\n\n\n    var softRevalidate = function softRevalidate() {\n      return revalidate({\n        dedupe: true\n      });\n    }; // trigger a revalidation\n\n\n    if (config.revalidateOnMount || !config.initialData && config.revalidateOnMount === undefined) {\n      if (typeof latestKeyedData !== 'undefined') {\n        // delay revalidate if there's cache\n        // to not block the rendering\n        rAF(softRevalidate);\n      } else {\n        softRevalidate();\n      }\n    }\n\n    var pending = false;\n\n    var onFocus = function onFocus() {\n      if (pending || !configRef.current.revalidateOnFocus) return;\n      pending = true;\n      softRevalidate();\n      setTimeout(function () {\n        return pending = false;\n      }, configRef.current.focusThrottleInterval);\n    };\n\n    var onReconnect = function onReconnect() {\n      if (configRef.current.revalidateOnReconnect) {\n        softRevalidate();\n      }\n    }; // register global cache update listener\n\n\n    var onUpdate = function onUpdate(shouldRevalidate, updatedData, updatedError, updatedIsValidating, dedupe) {\n      if (shouldRevalidate === void 0) {\n        shouldRevalidate = true;\n      }\n\n      if (dedupe === void 0) {\n        dedupe = true;\n      } // update hook state\n\n\n      var newState = {};\n      var needUpdate = false;\n\n      if (typeof updatedData !== 'undefined' && !config.compare(stateRef.current.data, updatedData)) {\n        newState.data = updatedData;\n        needUpdate = true;\n      } // always update error\n      // because it can be `undefined`\n\n\n      if (stateRef.current.error !== updatedError) {\n        newState.error = updatedError;\n        needUpdate = true;\n      }\n\n      if (typeof updatedIsValidating !== 'undefined' && stateRef.current.isValidating !== updatedIsValidating) {\n        newState.isValidating = updatedIsValidating;\n        needUpdate = true;\n      }\n\n      if (needUpdate) {\n        dispatch(newState);\n      }\n\n      if (shouldRevalidate) {\n        if (dedupe) {\n          return softRevalidate();\n        } else {\n          return revalidate();\n        }\n      }\n\n      return false;\n    };\n\n    addRevalidator(FOCUS_REVALIDATORS, onFocus);\n    addRevalidator(RECONNECT_REVALIDATORS, onReconnect);\n    addRevalidator(CACHE_REVALIDATORS, onUpdate);\n    return function () {\n      // cleanup\n      dispatch = function dispatch() {\n        return null;\n      }; // mark it as unmounted\n\n\n      unmountedRef.current = true;\n      removeRevalidator(FOCUS_REVALIDATORS, onFocus);\n      removeRevalidator(RECONNECT_REVALIDATORS, onReconnect);\n      removeRevalidator(CACHE_REVALIDATORS, onUpdate);\n    };\n  }, [key, revalidate]);\n  useIsomorphicLayoutEffect(function () {\n    var timer = null;\n\n    var tick = function tick() {\n      return __awaiter(_this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!(!stateRef.current.error && (configRef.current.refreshWhenHidden || configRef.current.isDocumentVisible()) && (configRef.current.refreshWhenOffline || configRef.current.isOnline()))) return [3\n              /*break*/\n              , 2]; // only revalidate when the page is visible\n              // if API request errored, we stop polling in this round\n              // and let the error retry function handle it\n\n              return [4\n              /*yield*/\n              , revalidate({\n                dedupe: true\n              })];\n\n            case 1:\n              // only revalidate when the page is visible\n              // if API request errored, we stop polling in this round\n              // and let the error retry function handle it\n              _a.sent();\n\n              _a.label = 2;\n\n            case 2:\n              // Read the latest refreshInterval\n              if (configRef.current.refreshInterval && !stateRef.current.error) {\n                timer = setTimeout(tick, configRef.current.refreshInterval);\n              }\n\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    if (configRef.current.refreshInterval) {\n      timer = setTimeout(tick, configRef.current.refreshInterval);\n    }\n\n    return function () {\n      if (timer) clearTimeout(timer);\n    };\n  }, [config.refreshInterval, config.refreshWhenHidden, config.refreshWhenOffline, revalidate]); // define returned state\n  // can be memorized since the state is a ref\n\n  var memoizedState = useMemo(function () {\n    var state = {\n      revalidate: revalidate,\n      mutate: boundMutate\n    };\n    Object.defineProperties(state, {\n      error: {\n        // `key` might be changed in the upcoming hook re-render,\n        // but the previous state will stay\n        // so we need to match the latest key and data (fallback to `initialData`)\n        get: function get() {\n          stateDependencies.current.error = true;\n          return keyRef.current === key ? stateRef.current.error : initialError;\n        },\n        enumerable: true\n      },\n      data: {\n        get: function get() {\n          stateDependencies.current.data = true;\n          return keyRef.current === key ? stateRef.current.data : initialData;\n        },\n        enumerable: true\n      },\n      isValidating: {\n        get: function get() {\n          stateDependencies.current.isValidating = true;\n          return stateRef.current.isValidating;\n        },\n        enumerable: true\n      }\n    });\n    return state;\n  }, [revalidate]); // suspense\n\n  if (config.suspense) {\n    // in suspense mode, we can't return empty state\n    // (it should be suspended)\n    // try to get data and error from cache\n    var latestData = cache.get(key);\n    var latestError = cache.get(keyErr);\n\n    if (typeof latestData === 'undefined') {\n      latestData = initialData;\n    }\n\n    if (typeof latestError === 'undefined') {\n      latestError = initialError;\n    }\n\n    if (typeof latestData === 'undefined' && typeof latestError === 'undefined') {\n      // need to start the request if it hasn't\n      if (!CONCURRENT_PROMISES[key]) {\n        // trigger revalidate immediately\n        // to get the promise\n        // in this revalidate, should not rerender\n        revalidate();\n      }\n\n      if (CONCURRENT_PROMISES[key] && typeof CONCURRENT_PROMISES[key].then === 'function') {\n        // if it is a promise\n        throw CONCURRENT_PROMISES[key];\n      } // it's a value, return it directly (override)\n\n\n      latestData = CONCURRENT_PROMISES[key];\n    }\n\n    if (typeof latestData === 'undefined' && latestError) {\n      // in suspense mode, throw error if there's no content\n      throw latestError;\n    } // return the latest data / error from cache\n    // in case `key` has changed\n\n\n    return {\n      error: latestError,\n      data: latestData,\n      revalidate: revalidate,\n      mutate: boundMutate,\n      isValidating: stateRef.current.isValidating\n    };\n  }\n\n  return memoizedState;\n}\n\nvar SWRConfig = SWRConfigContext.Provider;\nexport { trigger, mutate, SWRConfig };\nexport default useSWR;","export * from './use-swr';\nimport { default as useSWR } from './use-swr';\nexport { useSWRInfinite } from './use-swr-infinite';\nexport { cache } from './config';\nexport default useSWR;","import {useRef} from \"react\";\nimport useSWR from \"swr\";\nimport {baseUrl} from \"../../plugins/gatsby-source-animethemes/src/index\";\n\nconst fields = [ \"anime\", \"themes\", \"artists\" ];\nconst emptyResults = {\n    animeResults: [],\n    themeResults: [],\n    artistResults: []\n};\n\nexport default function useSearch(query) {\n    const { data: results, isValidating } = useSWR(\n        `${baseUrl}/api/search?fields=${fields.join()}&q=${encodeURIComponent(query)}`,\n        fetchSearchResults\n    );\n\n    const stickyResults = useRef(emptyResults);\n    if (!query) {\n        stickyResults.current = emptyResults;\n    } else if (results !== undefined) {\n        stickyResults.current = results;\n    }\n\n    return [ stickyResults.current, isValidating ];\n}\n\nasync function fetchSearchResults(url) {\n    const res = await fetch(url);\n    const { anime, themes, artists } = await res.json();\n\n    // Map artist to performances to comply with the application schema\n    for (const theme of themes) {\n        theme.song.performances = theme.song.artists.map((artist) => ({\n            artist,\n            as: artist.as\n        }));\n    }\n\n    return {\n        animeResults: anime,\n        themeResults: themes,\n        artistResults: artists\n    };\n}\n","import React from \"react\";\nimport {useLocation} from \"@reach/router\";\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faChevronDown} from \"@fortawesome/free-solid-svg-icons\";\nimport useSearch from \"hooks/useSearch\";\nimport AnimeSearchResultCard from \"components/card/searchResult/anime\";\nimport ThemeSearchResultCard from \"components/card/searchResult/theme\";\nimport Button from \"components/button\";\nimport Text from \"components/text\";\nimport Title from \"components/text/title\";\nimport ArtistSearchResultCard from \"components/card/searchResult/artist\";\nimport { Box, Flex } from \"components/flex\";\n\nexport default function GlobalSearch({ searchQuery, searchEntity }) {\n    const [ results, isSearching ] = useSearch(searchQuery);\n\n    if (!searchQuery) {\n        return (\n            <Text block>Type in a query to begin searching.</Text>\n        );\n    }\n\n    const {animeResults, themeResults, artistResults} = results;\n    const totalResults = animeResults.length + themeResults.length + artistResults.length;\n\n    if (!totalResults) {\n        if (isSearching) {\n            return (\n                <Text block>Searching...</Text>\n            );\n        }\n\n        return (\n            <Text block>No results found for query &quot;{searchQuery}&quot;. Did you spell it correctly?</Text>\n        );\n    }\n\n    return (\n        <Box gapsColumn=\"2rem\">\n            <EntitySearch searchEntity={searchEntity} entity=\"anime\" title=\"Anime\" results={animeResults}/>\n            <EntitySearch searchEntity={searchEntity} entity=\"theme\" title=\"Themes\" results={themeResults}/>\n            <EntitySearch searchEntity={searchEntity} entity=\"artist\" title=\"Artist\" results={artistResults}/>\n        </Box>\n    );\n}\n\nfunction EntitySearch({ searchEntity, entity, title, results }) {\n    const { search, hash } = useLocation();\n    const urlSuffix = search + hash;\n    const totalResults = results.length;\n\n    if ((searchEntity && searchEntity !== entity) || !results.length) {\n        return null;\n    }\n\n    // If no entity is selected, just show a preview with 3 results\n    if (!searchEntity) {\n        results = results.slice(0, 3);\n    }\n\n    let resultCards = results.map((result) => {\n        switch (entity) {\n            case \"anime\":\n                return <AnimeSearchResultCard key={result.id} anime={result}/>;\n            case \"theme\":\n                return <ThemeSearchResultCard key={result.id} theme={result}/>;\n            case \"artist\":\n                return <ArtistSearchResultCard key={result.id} artist={result}/>;\n            default:\n                return null;\n        }\n    });\n\n    return (\n        <Box gapsColumn=\"1rem\">\n            {!searchEntity && (\n                <Title variant=\"section\">{title}</Title>\n            )}\n            {resultCards}\n            {!searchEntity && totalResults > 3 && (\n                <Flex justifyContent=\"center\">\n                    <Button to={`/search/${entity}${urlSuffix}`} icon>\n                        <FontAwesomeIcon icon={faChevronDown} fixedWidth/>\n                    </Button>\n                </Flex>\n            )}\n        </Box>\n    );\n}\n","import {useEffect, useMemo, useState} from \"react\";\nimport styled from \"styled-components\";\nimport {navigate} from \"gatsby\";\nimport {useDebounce} from \"use-debounce\";\nimport SearchInput from \"components/input/search\";\nimport GlobalSearch from \"components/search/global\";\nimport {gapsColumn, gapsRow} from \"styles/mixins\";\nimport Title from \"components/text/title\";\nimport { Box, Flex } from \"components/flex\";\nimport Switcher from \"components/switcher\";\nimport Button from \"components/button\";\nimport SEO from \"components/seo\";\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faTimes} from \"@fortawesome/free-solid-svg-icons\";\n\nconst StyledSearchPage = styled.div`\n    ${gapsColumn(\"1.5rem\")}\n`;\nconst StyledSearchOptions = styled(Flex)`\n    @media (min-width: 721px) {\n        flex-direction: row;\n        ${gapsRow(\"1rem\")}\n    }\n    @media (max-width: 720px) {\n        flex-direction: column;\n        align-items: center;\n        ${gapsColumn(\"1rem\")}\n    }\n`;\n\nexport default function SearchPage({ location: { pathname, search, hash } }) {\n    const entity = useMemo(() => pathname.match(/\\/search(?:\\/(.+))?/)[1], [ pathname ]);\n    const urlParams = useMemo(() => new URLSearchParams(search), [ search ]);\n    const urlSuffix = search + hash;\n\n    const [ searchQuery, setSearchQuery ] = useState(urlParams.get(\"q\") || \"\");\n    const [ debouncedSearchQuery ] = useDebounce(searchQuery, 500);\n\n    // Generates page title based on search query\n    const pageTitle = searchQuery && searchQuery.trim()\n        ? `${searchQuery} - Search`\n        : \"Search\";\n\n    // Temporary effect to listen for changes to the search query that may be made by the quick search (WIP)\n    useEffect(() => { setSearchQuery(urlParams.get(\"q\")) }, [ urlParams ]);\n\n    useEffect(() => {\n        // Update URL to maintain the searchQuery on page navigation.\n        const newUrlParams = new URLSearchParams();\n        if (searchQuery) {\n            newUrlParams.set(\"q\", searchQuery);\n        }\n        const params = newUrlParams.toString();\n\n        let url = \"/search\";\n        if (entity) {\n            url += `/${entity}`;\n        }\n        if (params) {\n            url += `?${params}`;\n        }\n\n        navigate(url, { replace: true });\n    }, [ entity, searchQuery ]);\n\n    return (\n        <StyledSearchPage>\n            <SEO title={pageTitle} />\n            <Title>Search</Title>\n            <StyledSearchOptions>\n                <Box flex=\"1\">\n                    <SearchInput query={searchQuery} setQuery={setSearchQuery} isSearching={false}/>\n                </Box>\n                <Switcher>\n                    {!!entity && (\n                        <Button icon to={`/search${urlSuffix}`}>\n                            <FontAwesomeIcon icon={faTimes} fixedWidth/>\n                        </Button>\n                    )}\n                    <Button to={`/search/anime${urlSuffix}`} active={entity === \"anime\"}>Anime</Button>\n                    <Button to={`/search/theme${urlSuffix}`} active={entity === \"theme\"}>Themes</Button>\n                    <Button to={`/search/artist${urlSuffix}`} active={entity === \"artist\"}>Artists</Button>\n                </Switcher>\n            </StyledSearchOptions>\n            <GlobalSearch searchEntity={entity} searchQuery={debouncedSearchQuery}/>\n        </StyledSearchPage>\n    );\n}\n","const cache = new Map();\n\nfunction withCache(key, init) {\n    if (!cache.has(key)) {\n        cache.set(key, init(key));\n    }\n\n    return cache.get(key);\n}\n\nmodule.exports = withCache;\n","import {Link} from \"gatsby\";\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faEllipsisH} from \"@fortawesome/free-solid-svg-icons\";\nimport Button from \"components/button\";\nimport Text from \"components/text\";\nimport SearchResultCard, {SearchResultDescription} from \"components/card/searchResult\";\nimport Elevator from \"components/elevator\";\nimport ButtonPlay from \"components/button/play\";\nimport useImage from \"hooks/useImage\";\nimport createVideoSlug from \"utils/createVideoSlug\";\nimport { Flex } from \"components/flex\";\n\nexport default function AnimeSearchResultCard({ anime, hideThemes = false }) {\n    const { smallCover } = useImage(anime);\n\n    const animeLink = `/anime/${anime.slug}`;\n\n    let premiere = anime.year;\n    let premiereLink = `/year/${anime.year}`;\n    if (anime.season) {\n        premiere = anime.season + \" \" + premiere;\n        premiereLink += `/${anime.season.toLowerCase()}`;\n    }\n\n    let description = (\n        <SearchResultDescription>\n            <span>Anime</span>\n            {!!premiere && (\n                <Link to={premiereLink}>\n                    <Text link>{premiere}</Text>\n                </Link>\n            )}\n            <span>{anime.themes.length} themes</span>\n        </SearchResultDescription>\n    );\n\n    return (\n        <SearchResultCard\n            title={anime.name}\n            description={description}\n            image={smallCover}\n            to={animeLink}\n        >\n            {!hideThemes && (\n                <Elevator>\n                    <Flex flexWrap=\"wrap\" gapsBoth=\"0.75rem\">\n                        {anime.themes\n                            .slice(0, 4)\n                            .filter((theme) => theme.entries.length && theme.entries[0].videos.length)\n                            .map((theme) => {\n                                const entry = theme.entries[0];\n                                const video = entry.videos[0];\n                                const videoSlug = createVideoSlug(theme, entry, video);\n\n                                return (\n                                    <ButtonPlay key={theme.slug} to={`/anime/${anime.slug}/${videoSlug}`}>\n                                        <Text small block>{theme.slug}</Text>\n                                    </ButtonPlay>\n                                );\n                            })\n                        }\n                        {anime.themes.length > 4 && (\n                            <Button icon title=\"Show all themes\" to={animeLink}>\n                                <FontAwesomeIcon icon={faEllipsisH} fixedWidth/>\n                            </Button>\n                        )}\n                    </Flex>\n                </Elevator>\n            )}\n        </SearchResultCard>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faCircleNotch, faPlay} from \"@fortawesome/free-solid-svg-icons\";\nimport Button from \"components/button\";\n\nconst StyledButtonPlay = styled(Button)`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n\n    margin-left: 1rem;\n    padding: 0 0.5rem 0 0;\n`;\nconst StyledPrefix = styled.div`\n    display: inline-flex;\n    justify-content: center;\n    align-items: center;\n\n    width: 2rem;\n    height: 2rem;\n    margin-left: -1rem;\n    border-radius: 1rem;\n\n    background-color: ${(props) => props.theme.colors.secondaryBackground};\n    color: ${(props) => props.theme.colors.primaryBackground[0]};\n`;\nconst StyledBody = styled.div`\n    padding: 0.5rem;  \n`;\n\nexport default function ButtonPlay({ children, playing, ...props }) {\n    return (\n        <StyledButtonPlay {...props}>\n            <StyledPrefix>\n                <FontAwesomeIcon icon={playing ? faCircleNotch : faPlay} spin={playing} fixedWidth />\n            </StyledPrefix>\n            <StyledBody>\n                {children}\n            </StyledBody>\n        </StyledButtonPlay>\n    );\n}\n","const fetch = require(\"node-fetch\");\nconst withCache = require(\"./utils/withCache\");\n\nconst baseUrl = process.env.GATSBY_API_URL || \"https://staging.animethemes.moe\";\n\nconst requestCooldown = 1000;\nlet lastRequest;\n\nasync function fetchJsonCached(url, init) {\n    // Debounce, we should only request once every second\n    if (lastRequest) {\n        const expiredTime = Date.now() - lastRequest;\n        if (expiredTime < requestCooldown) {\n            await sleep(requestCooldown - expiredTime);\n        }\n    }\n\n    lastRequest = Date.now();\n\n    return await withCache(\n        url,\n        (url) => fetch(url, init).then((response) => response.json())\n    );\n}\n\nfunction createFieldParams(fields) {\n    return Object.entries(fields)\n        .map(([ key, values ]) => `fields[${key}]=${values.join()}`)\n        .join(\"&\");\n}\n\nfunction sleep(millis) {\n    return new Promise((resolve) => setTimeout(resolve, millis));\n}\n\nmodule.exports = {\n    baseUrl,\n    fetchJsonCached,\n    createFieldParams\n};\n","import React from \"react\";\nimport useAniListArtist from \"hooks/useAniListArtist\";\nimport SearchResultCard, {SearchResultDescription} from \"components/card/searchResult\";\n\nexport default function ArtistSearchResultCard({ artist }) {\n    const { image } = useAniListArtist(artist);\n\n    const description = (\n        <SearchResultDescription>\n            <span>Artist</span>\n            {!!artist.performances && (\n                <span>{artist.performances.length} songs</span>\n            )}\n        </SearchResultDescription>\n    );\n\n    return (\n        <SearchResultCard\n            title={artist.name}\n            description={description}\n            image={image}\n            to={`/artist/${artist.slug}`}\n        />\n    );\n}\n","\"use strict\"; // ref: https://github.com/tc39/proposal-global\n\nvar getGlobal = function getGlobal() {\n  // the only reliable means to get the global object is\n  // `Function('return this')()`\n  // However, this causes CSP violations in Chrome apps.\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n\n  throw new Error('unable to locate global object');\n};\n\nvar global = getGlobal();\nmodule.exports = exports = global.fetch; // Needed for TypeScript and Webpack.\n\nif (global.fetch) {\n  exports.default = global.fetch.bind(global);\n}\n\nexports.Headers = global.Headers;\nexports.Request = global.Request;\nexports.Response = global.Response;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;"],"sourceRoot":""}